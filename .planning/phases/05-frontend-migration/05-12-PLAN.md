---
phase: 05-frontend-migration
plan: 12
type: execute
wave: 5
depends_on: ['05-10']
files_modified:
  - N/A - verification only
autonomous: false

must_haves:
  truths:
    - 'Frontend starts without errors'
    - 'Login flow completes successfully'
    - 'Dashboard renders with data from new API'
    - 'Navigation works across entity hierarchy'
  artifacts: []
  key_links: []
---

<objective>
Verify frontend migration with manual integration testing.

Purpose: Confirm the migration works end-to-end by testing the frontend against the local backend.

Output:

- Verification that frontend starts
- Login flow works
- Core pages render
- Data flows correctly
  </objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/05-frontend-migration/05-10-SUMMARY.md
@.planning/phases/05-frontend-migration/05-11-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify build and type check</name>
  <files>N/A</files>
  <action>
Run build and type check to verify migration:

```bash
# Type check entire codebase
pnpm tsc --noEmit

# Build frontend
pnpm build

# Run linter
pnpm lint
```

Fix any type errors or build issues discovered.

Common issues to check:

- Import paths resolve correctly
- No missing types
- No unused imports causing errors
- ESLint rules pass
  </action>
  <verify>All commands complete successfully with no errors</verify>
  <done>Frontend builds and type checks without errors</done>
  </task>

<task type="auto">
  <name>Task 2: Start services and verify connectivity</name>
  <files>N/A</files>
  <action>
Start all services and verify they connect:

**Terminal 1 - Start infrastructure:**

```bash
docker compose up -d
```

**Terminal 2 - Start backend:**

```bash
cd backend
pnpm dev
```

Wait for backend to start, should see:

- "Server listening at http://localhost:3000"
- No database connection errors

**Terminal 3 - Start frontend:**

```bash
pnpm dev
```

Wait for frontend to start, should see:

- "VITE v5.x.x ready"
- "Local: http://localhost:5173"

**Verify connectivity:**

1. Open http://localhost:5173 in browser
2. Open browser DevTools (F12) -> Network tab
3. Check that API requests go to correct URL
4. Check console for any CORS or connection errors
   </action>
   <verify>Frontend loads, no CORS errors, API requests visible in Network tab</verify>
   <done>All services running and connected</done>
   </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete frontend migration from Supabase to new self-hosted backend:
- API client with Ky and auth interceptor
- TypeScript types matching backend schemas
- 27 hooks migrated from Supabase to new API
- Stack Auth integration for token management
- Unit tests for API client and critical hooks
  </what-built>
  <how-to-verify>
**Prerequisites:** Backend running at localhost:3000, frontend at localhost:5173

1. **Login Flow:**
   - Open http://localhost:5173
   - Click login (should redirect to Stack Auth)
   - Complete login
   - Verify redirect back to dashboard

2. **Dashboard:**
   - After login, dashboard should load
   - Check Network tab - requests go to /api/orgs/...
   - Organization name should display
   - Navigation tree should load (sites, areas, units)

3. **Navigation:**
   - Click on a site in nav tree
   - Site detail page should load
   - Click on an area
   - Click on a unit
   - Unit detail should show (possibly with TODO placeholders for readings)

4. **Console Check:**
   - Open DevTools Console
   - Look for [API Error] logs if any requests fail
   - Should NOT see Supabase-related errors
   - May see TODO warnings for non-migrated features

5. **Error Handling:**
   - Try accessing a non-existent route
   - Error should display in UI (not just console)

**Expected state:**

- Login works via Stack Auth
- Dashboard renders with org data
- Nav tree shows sites/areas/units
- Some features may show TODO placeholders
- No critical errors in console
  </how-to-verify>
  <resume-signal>
  Type "approved" if all checks pass.
  Or describe issues found: "Issue: [description]"
  </resume-signal>
  </task>

</tasks>

<verification>
1. `pnpm build` completes without errors
2. `pnpm tsc --noEmit` passes
3. Frontend loads in browser
4. Login flow completes
5. Dashboard renders with data
6. No critical console errors
</verification>

<success_criteria>

- Build passes
- Type check passes
- Frontend connects to backend
- Login via Stack Auth works
- Core pages render with data
- Error handling visible in console AND UI
  </success_criteria>

<output>
After completion, create `.planning/phases/05-frontend-migration/05-12-SUMMARY.md`
</output>
