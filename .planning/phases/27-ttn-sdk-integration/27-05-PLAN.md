---
phase: 27
plan: 05
wave: 4
gap_closure: false
---

# Plan 27-05: Frontend Hook Migration

## Goal

Update frontend hooks to use the new tRPC procedures instead of Supabase Edge Functions.

## Requirements

- Update `useTTNSettings.ts`
- Update `useTTNApiKey.ts`
- Update `useTTNWebhook.ts`
- Update `useTTNSetupWizard.ts`

## Tasks

<task>
<name>Migrate useTTNSettings</name>
<description>
Replace `supabase.functions.invoke("manage-ttn-settings")` with `trpc.ttnSettings.get` usage.
</description>
<file>src/hooks/useTTNSettings.ts</file>
<verify>
grep "trpc.ttnSettings" src/hooks/useTTNSettings.ts
! grep "supabase.functions.invoke" src/hooks/useTTNSettings.ts
</verify>
</task>

<task>
<name>Migrate useTTNApiKey</name>
<description>
Replace `supabase.functions.invoke("ttn-bootstrap")` with `trpc.ttnSettings.validateApiKey` and `saveAndConfigure`.
</description>
<file>src/hooks/useTTNApiKey.ts</file>
<verify>
grep "trpc.ttnSettings" src/hooks/useTTNApiKey.ts
</verify>
</task>

<task>
<name>Migrate useTTNWebhook</name>
<description>
Replace `supabase.functions.invoke("update-ttn-webhook")` with `trpc.ttnSettings.updateWebhook`.
</description>
<file>src/hooks/useTTNWebhook.ts</file>
<verify>
grep "trpc.ttnSettings" src/hooks/useTTNWebhook.ts
</verify>
</task>

<task>
<name>Migrate useTTNSetupWizard</name>
<description>
Update wizard to use tRPC queries/mutations.
</description>
<file>src/hooks/useTTNSetupWizard.ts</file>
<verify>
grep "trpc.ttnSettings" src/hooks/useTTNSetupWizard.ts
</verify>
</task>
