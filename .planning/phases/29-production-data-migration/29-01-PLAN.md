---
phase: 29-production-data-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: false

must_haves:
  truths:
    - 'Production migration window scheduled and communicated'
    - 'Source and target database connections validated'
    - 'Migration runbook and rollback criteria reviewed'
    - 'Target database schema is up to date'
  artifacts: []
  key_links: []
---

<objective>
Prepare and verify production readiness for the data migration.

Purpose: Eliminate avoidable execution risks before the maintenance window starts.
Output: Confirmed readiness with validated connections, up-to-date schema, and a reviewed rollback plan.
</objective>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-production-data-migration/29-RESEARCH.md
@scripts/migration/README.md
@docs/CUTOVER_CHECKLIST.md
@docs/PRODUCTION_DEPLOYMENT.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Checkpoint 1: Validate migration environment</name>
  <what-built>All prerequisites are validated in the migration environment.</what-built>
  <how-to-verify>
1. Install migration dependencies:
   ```bash
   cd scripts/migration
   pnpm install
   ```
2. Verify source/target connections:
   ```bash
   pnpm run test-connections
   ```
3. Confirm target schema is current (from production deployment host):
   ```bash
   pnpm --prefix backend run db:migrate
   ```
4. Dry-run export to confirm access without writing:
   ```bash
   pnpm run export -- --dry-run
   ```
  </how-to-verify>
  <resume-signal>Type "env-ready" when all checks pass</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Checkpoint 2: Cutover readiness review</name>
  <what-built>Operations and communication readiness confirmed.</what-built>
  <how-to-verify>
- [ ] Maintenance window scheduled (8+ hours)
- [ ] User communications prepared (T-48h and T-24h)
- [ ] DNS TTL lowered per cutover checklist
- [ ] Rollback criteria reviewed with stakeholders
- [ ] On-call contacts confirmed for the window
  </how-to-verify>
  <resume-signal>Type "cutover-ready" when the readiness review is complete</resume-signal>
</task>

</tasks>
