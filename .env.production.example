# ================================================
# FreshTrack Pro - Production Environment Variables
# ================================================
#
# IMPORTANT: Never commit the actual .env file with real values!
#
# 1. Copy this file to .env and fill in your values
# 2. Use file-based secrets in ./secrets/ for sensitive data
# 3. See docs/ENVIRONMENT_VARIABLES.md for full documentation
#
# Legend:
#   [REQUIRED]  - Must be set for the application to work
#   [OPTIONAL]  - Has sensible defaults, customize as needed
#   [SECRET]    - Sensitive, use secrets/ directory instead
#   [COMPUTED]  - Derived from other variables, rarely needs changing

# ===========================================
# Core Application
# ===========================================

# [REQUIRED] Application environment
NODE_ENV=production

# [OPTIONAL] Server configuration
PORT=3000
HOST=0.0.0.0
LOG_LEVEL=info

# ===========================================
# Domain Configuration
# ===========================================

# [REQUIRED] Primary domain (used by Traefik for routing)
DOMAIN=app.freshtrackpro.com

# [COMPUTED] Frontend and API URLs (derived from DOMAIN)
FRONTEND_URL=https://${DOMAIN}
API_URL=https://${DOMAIN}/api

# [OPTIONAL] ACME email for Let's Encrypt SSL certificates
ACME_EMAIL=admin@freshtrackpro.com

# ===========================================
# Database (PostgreSQL)
# ===========================================

# [OPTIONAL] PostgreSQL user (default: frostguard)
POSTGRES_USER=frostguard

# [OPTIONAL] PostgreSQL database name (default: frostguard)
POSTGRES_DB=frostguard

# [SECRET] PostgreSQL password - use secrets/postgres_password.txt
# Do NOT set POSTGRES_PASSWORD here, use Docker secrets instead

# [COMPUTED] Full database connection string
# For Docker Compose, uses container hostname 'postgres'
# Password is injected from secrets at runtime
DATABASE_URL=postgresql://${POSTGRES_USER}@postgres:5432/${POSTGRES_DB}

# [OPTIONAL] Connection pool settings for high-traffic production
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_CONNECTION_TIMEOUT=5000

# ===========================================
# Redis (Cache, Socket.IO, Job Queues)
# ===========================================

# [REQUIRED] Redis connection URL
# Self-hosted (Docker): redis://redis:6379
# Managed (Redis Cloud): rediss://default:PASSWORD@host:6379
REDIS_URL=redis://redis:6379

# [OPTIONAL] Alternative Redis configuration (if not using REDIS_URL)
# REDIS_HOST=redis
# REDIS_PORT=6379

# ===========================================
# Stack Auth (Authentication)
# ===========================================

# [REQUIRED] Stack Auth project ID
STACK_AUTH_PROJECT_ID=your-stack-auth-project-id

# [REQUIRED] Stack Auth publishable key (safe to expose in frontend)
STACK_AUTH_PUBLISHABLE_KEY=your-publishable-key

# [SECRET] Stack Auth secret key - use secrets/stack_auth_secret.txt
# STACK_AUTH_SECRET_KEY - Set via Docker secret or GitHub secret

# [OPTIONAL] Stack Auth API URL (defaults to Stack Auth cloud)
STACK_AUTH_API_URL=https://api.stack-auth.com

# ===========================================
# MinIO / S3 (Object Storage)
# ===========================================

# [REQUIRED] MinIO/S3 endpoint
# Self-hosted (Docker): http://minio:9000
# AWS S3: https://s3.amazonaws.com
MINIO_ENDPOINT=http://minio:9000

# [OPTIONAL] MinIO bucket name
MINIO_BUCKET=frostguard

# [SECRET] MinIO/S3 credentials - use secrets/minio_user.txt & minio_password.txt
# MINIO_ROOT_USER - Set via Docker secret
# MINIO_ROOT_PASSWORD - Set via Docker secret

# [OPTIONAL] For accessing MinIO from backend (if not using Docker secrets)
# MINIO_ACCESS_KEY=your-access-key
# MINIO_SECRET_KEY=your-secret-key

# ===========================================
# Stripe (Payments)
# ===========================================

# [SECRET] Stripe API key - use GitHub secret STRIPE_SECRET_KEY
# STRIPE_SECRET_KEY=sk_live_...

# [SECRET] Stripe webhook signing secret
# STRIPE_WEBHOOK_SECRET=whsec_...

# ===========================================
# The Things Network (IoT)
# ===========================================

# [REQUIRED if using TTN] TTN application ID
TTN_APPLICATION_ID=your-ttn-app-id

# [SECRET] TTN API key for device management
# TTN_API_KEY=NNSXS.xxx

# [OPTIONAL] TTN API URL (default: The Things Stack cloud)
TTN_API_URL=https://eu1.cloud.thethings.network

# [SECRET] TTN webhook secret for incoming data
# TTN_WEBHOOK_SECRET=your-webhook-secret

# ===========================================
# Telnyx (SMS Notifications)
# ===========================================

# [SECRET] Telnyx API key
# TELNYX_API_KEY=KEY_xxx

# [OPTIONAL] Telnyx messaging profile ID
TELNYX_MESSAGING_PROFILE_ID=your-profile-id

# [OPTIONAL] Telnyx from phone number (E.164 format)
TELNYX_PHONE_NUMBER=+15551234567

# ===========================================
# Resend (Email)
# ===========================================

# [SECRET] Resend API key for transactional emails
# RESEND_API_KEY=re_xxx

# [OPTIONAL] Email from address
EMAIL_FROM_ADDRESS=noreply@freshtrack.app

# [OPTIONAL] Application URL for email links
APP_URL=https://app.freshtrackpro.com

# ===========================================
# Security & CORS
# ===========================================

# [REQUIRED] CORS allowed origins (comma-separated)
CORS_ORIGINS=https://app.freshtrackpro.com,https://www.freshtrackpro.com

# [OPTIONAL] Rate limiting (requests per minute)
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX=100

# [OPTIONAL] Session cookie configuration
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_SAMESITE=strict
SESSION_COOKIE_DOMAIN=.freshtrackpro.com

# ===========================================
# Feature Flags
# ===========================================

# [OPTIONAL] Enable/disable features
FEATURE_DEVICE_PROVISIONING=true
FEATURE_SMS_NOTIFICATIONS=true
FEATURE_EMAIL_NOTIFICATIONS=true
FEATURE_WEBHOOK_INTEGRATIONS=true

# ===========================================
# Monitoring & Observability
# ===========================================

# [OPTIONAL] Enable Sentry error tracking
APM_ENABLED=false
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# [OPTIONAL] Prometheus metrics export
METRICS_ENABLED=false
METRICS_PORT=9090

# ===========================================
# Traefik Dashboard (Optional)
# ===========================================

# [OPTIONAL] Basic auth for Traefik dashboard
# Generate with: htpasswd -nb admin your-password
TRAEFIK_DASHBOARD_AUTH=admin:$$apr1$$xxx$$xxx

# ===========================================
# Secrets Configuration
# ===========================================
#
# The following secrets should NOT be set as environment variables.
# Instead, create files in the ./secrets/ directory:
#
# Required secret files:
#   - secrets/postgres_password.txt    - PostgreSQL password
#   - secrets/minio_user.txt           - MinIO root username
#   - secrets/minio_password.txt       - MinIO root password
#
# Optional secret files (or set via GitHub Secrets for CD):
#   - secrets/stack_auth_secret.txt    - Stack Auth secret key
#   - secrets/jwt_secret.txt           - JWT signing secret
#   - secrets/grafana_password.txt     - Grafana admin password
#
# See secrets/README.md for setup instructions
