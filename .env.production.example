# FreshTrack Pro Production Environment
# Copy to .env.production and fill in values
#
# IMPORTANT: Secrets should NOT be in this file
# Use file-based secrets in ./secrets/ directory instead

# ===========================================
# Application
# ===========================================
NODE_ENV=production
LOG_LEVEL=info
PORT=3000
HOST=0.0.0.0

# ===========================================
# Domain Configuration
# ===========================================
# Update these to match your production domain
FRONTEND_URL=https://app.freshtrackpro.com
API_URL=https://api.freshtrackpro.com
MONITORING_URL=https://monitoring.freshtrackpro.com
STATUS_URL=https://status.freshtrackpro.com

# ===========================================
# Database (PostgreSQL)
# ===========================================
# For managed PostgreSQL (e.g., DigitalOcean, AWS RDS):
# - Use connection string with sslmode=require
# - Password should be in secrets/postgres_password.txt
#
# Example formats:
# Self-hosted: postgresql://frostguard:PASSWORD@postgres:5432/frostguard
# Managed:     postgresql://user:PASSWORD@host:25060/database?sslmode=require
#
DATABASE_URL=postgresql://frostguard:${POSTGRES_PASSWORD}@postgres:5432/frostguard

# Connection pool settings (for high-traffic production)
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_CONNECTION_TIMEOUT=5000

# ===========================================
# Redis (Cache & Jobs)
# ===========================================
# Self-hosted Redis (Docker)
REDIS_URL=redis://redis:6379

# Managed Redis (e.g., Redis Cloud, AWS ElastiCache):
# REDIS_URL=rediss://default:PASSWORD@host:6379

# ===========================================
# MinIO / S3 (Object Storage)
# ===========================================
# Self-hosted MinIO (Docker)
MINIO_ENDPOINT=http://minio:9000
MINIO_BUCKET_ASSETS=assets
MINIO_USE_SSL=false

# Credentials (use file-based secrets in production):
# - secrets/minio_user.txt → MINIO_ROOT_USER
# - secrets/minio_password.txt → MINIO_ROOT_PASSWORD

# AWS S3 (alternative to MinIO):
# MINIO_ENDPOINT=https://s3.amazonaws.com
# MINIO_BUCKET_ASSETS=freshtrack-production-assets
# MINIO_REGION=us-east-1
# MINIO_USE_SSL=true

# ===========================================
# Stack Auth (Authentication Service)
# ===========================================
STACK_AUTH_PROJECT_ID=your-stack-auth-project-id
STACK_AUTH_API_URL=https://api.stack-auth.com

# Stack Auth publishable key (safe to expose in frontend)
STACK_AUTH_PUBLISHABLE_KEY=your-publishable-key

# ===========================================
# External Services
# ===========================================

# TTN (The Things Network) - Required for IoT device integration
TTN_API_URL=https://eu1.cloud.thethings.network
TTN_APPLICATION_ID=your-ttn-application-id
TTN_API_KEY=your-ttn-api-key
TTN_WEBHOOK_URL=https://api.freshtrackpro.com/api/webhooks/ttn

# Stripe (Payment Processing) - Required for subscriptions
# Get keys from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_live_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-signing-secret

# Resend (Email Delivery) - Required for notifications
# Get API key from: https://resend.com/api-keys
RESEND_API_KEY=re_your-resend-api-key
EMAIL_FROM_ADDRESS=noreply@freshtrackpro.com

# Telnyx (SMS Notifications) - Optional
TELNYX_API_KEY=your-telnyx-api-key
TELNYX_MESSAGING_PROFILE_ID=your-messaging-profile-id
TELNYX_PHONE_NUMBER=+15551234567

# ===========================================
# Feature Flags
# ===========================================
# Enable/disable features in production
FEATURE_DEVICE_PROVISIONING=true
FEATURE_SMS_NOTIFICATIONS=true
FEATURE_EMAIL_NOTIFICATIONS=true
FEATURE_WEBHOOK_INTEGRATIONS=true

# ===========================================
# Monitoring & Observability
# ===========================================
# Application Performance Monitoring (Sentry)
# Get DSN from: https://sentry.io/settings/projects/
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Application URL (used in email templates and digest links)
APP_URL=https://app.freshtrackpro.com

# Metrics export (Prometheus)
METRICS_ENABLED=false
METRICS_PORT=9090

# ===========================================
# Security
# ===========================================
# CORS allowed origins (comma-separated)
CORS_ORIGINS=https://app.freshtrackpro.com,https://www.freshtrackpro.com

# Rate limiting (requests per minute)
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX=100

# Session configuration
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_SAMESITE=strict
SESSION_COOKIE_DOMAIN=.freshtrackpro.com

# ===========================================
# Secrets (DO NOT PUT VALUES HERE)
# ===========================================
# Use file-based secrets instead:
# - secrets/postgres_password.txt  → PostgreSQL password
# - secrets/jwt_secret.txt         → JWT signing secret (generate with: openssl rand -base64 32)
# - secrets/stack_auth_secret.txt  → Stack Auth secret key
# - secrets/minio_user.txt         → MinIO root username
# - secrets/minio_password.txt     → MinIO root password
# - secrets/grafana_password.txt   → Grafana admin password
#
# Generate secure secrets:
#   openssl rand -base64 32 > secrets/postgres_password.txt
#   openssl rand -base64 32 > secrets/jwt_secret.txt
#   openssl rand -base64 32 > secrets/minio_password.txt
#   openssl rand -base64 32 > secrets/grafana_password.txt
#
# See secrets/README.md for complete setup instructions
