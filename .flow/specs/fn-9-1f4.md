# fn-9-1f4 Error Boundary & Loading State Improvements

## Overview

Improve error handling and loading UX using React 18 patterns. Current App.tsx Suspense fallback is minimal text ("Loading..."). Error boundaries exist but are not placed per-route. No QueryErrorResetBoundary integration with TanStack Query.

## Scope

- Add per-route error boundaries in App.tsx route definitions
- Replace App.tsx "Loading..." Suspense fallback with proper skeleton layout
- Add QueryErrorResetBoundary + ErrorBoundary pattern for data-fetching errors
- Create reusable PageSkeleton component matching DashboardLayout shape
- Do NOT migrate to useSuspenseQuery (incremental, future epic)
- Do NOT change react-router from flat routes to createBrowserRouter (separate concern)

## Approach

1. Create PageSkeleton component (sidebar skeleton + content area skeleton)
2. Replace `<Suspense fallback={<div>Loading...</div>}>` with `<Suspense fallback={<PageSkeleton />}>`
3. Wrap route groups with ErrorBoundary fallbacks (dashboard, admin, platform)
4. Add QueryErrorResetBoundary around data-heavy routes for retry capability
5. Test error scenarios with intentional failures

## Quick commands

- `pnpm test`
- `pnpm dev` (visual verification)
- `pnpm build`

## Acceptance

- [ ] PageSkeleton component exists matching DashboardLayout structure
- [ ] App-level Suspense uses PageSkeleton instead of "Loading..." text
- [ ] At least 3 route groups wrapped with dedicated ErrorBoundary
- [ ] QueryErrorResetBoundary provides retry button on data fetch failures
- [ ] All tests pass, no visual regressions in dev

## References

- Repo scout: App.tsx:89-94 has minimal "Loading..." fallback
- Repo scout: Skeleton component exists at src/components/ui/skeleton.tsx
- Repo scout: WidgetEmptyState handles per-widget loading/error/offline states
- Practice scout: Combine QueryErrorResetBoundary + react-error-boundary for retry
- Practice scout: Per-route error boundaries prevent single failure from crashing app
